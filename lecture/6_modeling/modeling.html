<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data Analysis using R</title>
    <meta charset="utf-8" />
    <meta name="author" content="Sven Werenbeck-Ueding" />
    <script src="modeling_files/header-attrs-2.25/header-attrs.js"></script>
    <link href="modeling_files/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="modeling_files/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link href="modeling_files/panelset-0.3.0/panelset.css" rel="stylesheet" />
    <script src="modeling_files/panelset-0.3.0/panelset.js"></script>
    <link href="modeling_files/tile-view-0.2.6/tile-view.css" rel="stylesheet" />
    <script src="modeling_files/tile-view-0.2.6/tile-view.js"></script>
    <script src="modeling_files/htmlwidgets-1.6.4/htmlwidgets.js"></script>
    <script src="modeling_files/viz-1.8.2/viz.js"></script>
    <link href="modeling_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
    <script src="modeling_files/grViz-binding-1.0.11/grViz.js"></script>
    <script src="modeling_files/kePrint-0.0.1/kePrint.js"></script>
    <link href="modeling_files/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Data Analysis using R
]
.subtitle[
## Modeling
]
.author[
### Sven Werenbeck-Ueding
]
.date[
### 09.12.2024
]

---


&lt;!-- Setup --&gt;







<div class="grViz html-widget html-fill-item" id="htmlwidget-73b2b932f5740915b998" style="width:100%;height:504px;"></div>
<script type="application/json" data-for="htmlwidget-73b2b932f5740915b998">{"x":{"diagram":"\n  digraph {\n  graph [fontname=\"Helvetica,Arial,sans-serif\", compound = true]\n\tnode [fontname=\"Helvetica,Arial,sans-serif\"]\n\tedge [fontname=\"Helvetica,Arial,sans-serif\"]\n    \n    rankdir=LR\n    \n    subgraph cluster_0 {\n        style = rounded\n        color = black\n    \n        {\n            node [style = rounded, shape = box]\n            Import -> Tidy\n        }\n    \n        subgraph cluster_1 {\n            style = rounded\n            color = black\n            \n            node [style = rounded, shape = box]\n            Transform Visualize Model\n            \n            edge []\n            Transform -> Visualize\n            Visualize -> Model\n            Model -> Transform\n            \n            label = \"Exploration\"\n            labeljust = \"l\"\n            labelloc = \"b\"\n        }\n    \n        {\n            node [style = rounded, shape = box]\n            Communicate\n        }\n    \n        Tidy -> Transform [lhead = cluster_1]\n        Model -> Communicate [ltail = cluster_1]\n        \n        label = \"Programming\"\n        labeljust = \"l\"\n        labelloc = \"b\"\n    }\n  }\n  ","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script>

.right[*Source:* &lt;a name=cite-r4ds&gt;&lt;/a&gt;[Wickham and Grolemund (2016)](https://r4ds.had.co.nz/)]

---

class: middle

## Fenced Out:

### The Impact of Border Construction on U.S.-Mexico Migration

&gt; "This paper estimates the **impact of the US-Mexico border fence
on US-Mexico migration** by **exploiting variation in the timing and
location of US government investment in fence construction**. Using
Mexican survey data and data I collected on fence construction,
I find that construction in a municipality reduces migration by
27 percent for municipality residents and 15 percent for residents of
adjacent municipalities."
&gt;
&gt; .right[&lt;a name=cite-f20&gt;&lt;/a&gt;[Feigenberg (2020a)](https://www.aeaweb.org/articles?id=10.1257/app.20170231)]

---

layout: true

## Data

---

.pull-left[
#### Mexican Survey

- Encuesta Nacional de Ocupación y Empleo (ENOE) from Q3 2003 to Q3 2013

- Quarterly rotating panel: Households included for 5 quarters

- Records whether any household member leaves to the US

- Potential migrants are restricted from ages 15 to 65

- Explanatory variables: age, gender, marital status and education for all household members
]

--

.pull-right[
#### Fence Construction

- Data collected by identifying potential fence locations:

  - Documents from US authorities: Customs and Border Protection (CPB) and Government Accountability Office (GAO)
  - Local government reports
  - Published contracts with construction firms

- Cross-checked with an environmental organization tracking the impact of fence construction (Sierra Club)

- Provides quarterly information on fence construction on Mexican municipality level
]

---

layout: false
name: logit-model

## Identification Strategy

- By exploiting temporal and spatial variation in fence construction, [Feigenberg (2020a)](https://www.aeaweb.org/articles?id=10.1257/app.20170231) estimates the impact of fence construction on the migration decision of potential migrants

- Exogenous variation in fence construction allows for a difference-in-difference estimator of the form `$$Pr(Y_{mti}=1\mid z_{mti})=\frac{exp(\alpha+X_{mti}\beta+\delta\times fence_{mti}+\gamma_m+\tau_t)}{1+exp(\alpha+X_{mti}\beta+\delta\times fence_{mti}+\gamma_m+\tau_t)}$$`

  - `\(Y_{mti}\in[0,1]\)`: 1 if individual `\(i\)` living in municipality `\(m\)` migrates to the US in year-quarter `\(t\)`
  
  - `\(X_{mti}\)`: Socio-economic characteristics of individual `\(i\)` living in municipality `\(m\)` and year-quarter `\(t\)`
  
  - `\(fence_{mti}\in[0,1]\)`: 1 if fence construction started in municipality `\(m\)` in or before year-quarter `\(t\)`
  
  - `\(\gamma_m\)`, `\(\tau_t\)`: Municipality and year-quarter fixed effects
  
---

## Results

.pull-left[
- Table 2 shows log-odds coefficients of different specifications for the estimation strategy

- Column (2) of panel A employs the specification on the previous slide

- Fence construction reduces probability of migrating by `\(1-e^\delta=37.87\%\)`

- Relative to baseline migration rate of `\(4.2\)` per `\(1,000\)` respondents

- Parentheses show standard errors clustered by municipality

- Effect is highly significant: `\(p\)`-value is `\(\approx0\)`
]

.pull-right[
&lt;img src="../../resources/assets/feigenberg_2020_results.png" width="100%" style="display: block; margin: auto;" /&gt;

.right[*Source:* [Feigenberg (2020a)](https://www.aeaweb.org/articles?id=10.1257/app.20170231)]
]

---

## Prerequisites


```r
library(tidyverse)

# Import the data set and convert municipality and period identifiers to
# factor variables (both have to be converted to character first). Set the
# first period (Q3 2003, i.e. 0.5) as the reference category for the period
# identifier
df_mig &lt;- read_csv("data/processed/fence_migration.csv") %&gt;% 
  mutate(
    municipality = fct(as.character(municipality)),
    period = fct_relevel(as.character(period), "0.5")
  )
```



--

.pull-left.short-width[
.big-emoji[⚠️]
]

.pull-right.long-width[
- For this course, a random 50% sample of the full sample was drawn from the data set provided by &lt;a name=cite-f20data&gt;&lt;/a&gt;[Feigenberg (2020b)](https://www.aeaweb.org/journals/dataset?id=10.1257/app.20170231)

- Our results may differ
]

---

layout: false
class: middle

# Regressions in R

---

## Fit Linear Regressions in R


```r
?lm
```

The `lm()` function fits linear models, including multivariate models. It can also be used to carry out single stratum analysis of variance and analysis of covariance.

- `formula`: An object of class `formula` that symbollically describes the model to be fitted

- `data`: An object of class `data.frame` (or coercible by `as.data.frame`) containing the model variables

- `subset`: An optional vector for subsetting observations in `data`

- `weights`: An optional numeric vector of weights, e. g. for weighted least squares

---

## Formulas in R

Expressions such as `y ~ x1 + x2 + x3` use the `~` operator to specify that response `y` is modeled by a set of predictors (`x1`, `x2` and `x3`)

| Operator | Meaning | Example |
| --- | --- | --- |
| `:` | Interaction effect between two predictors | .center[`x1:x2`] |
| `*` | Main and interaction effects of predictors | .center[`x1*x2` &amp;rarr; `x1 + x2 + x1:x2`] |
| `^` | Expands to a formula containing main effects and interactions up to the `\(n^{th}\)` order | .center[`(x1 + x2 + x3)^2` &amp;rarr; &lt;br&gt; `x1 + x2 + x3 + x1:x2 + x1:x3 + x2:x3`] |
| `/` | Terms on the LHS are nested within those on the right | .center[`x1/x2` &amp;rarr; `x1 + x1:x2`] |
| `-` | Removes terms from the formula (e. g. the intercept) | .center[`y ~ -1 + x1`] |
| `.` | Usually interpreted as all `data` columns not otherwise in the formula | .center[`y ~ .`] |

---

## Binary Choice Models

| Model | Functional Form | Command |
| ----- | --------------- | ------- |
| LPM | `$$Pr(Y_i=1\mid X_i)=X_i\beta$$` | .center[`lm(y ~ .)`] |
| Logit | `$$Pr(Y_i = 1\mid X_i)=\wedge(X_i\beta)=\frac{e^{X_i\beta}}{1+e^{X_i\beta}}$$` | .center[`glm(y ~ ., family = "binomial")`] |
| Probit | `$$Pr(Y_i=1\mid X_i)=\phi(X_i\beta)=\int_{-\infty}^{X_i\beta}\phi(z)dz$$` | .center[`glm(y ~ ., binomial(link = "probit"))`] |

---

## Fitting a Linear Probability Model in base R

.panelset[
.panel[.panel-name[Task]
Estimate the impact of border fence construction on Mexican-US migration using a linear probability model akin to the logit model employed by [Feigenberg (2020a)](https://www.aeaweb.org/articles?id=10.1257/app.20170231). Use the data provided in `data/processed/fence_migration.csv`.

`$$Y_{mti}=\alpha+X_{mti}\beta+\delta\times fence_{mti}+\gamma_m+\tau_t$$`

- `\(Y_{mti}\in[0,1]\)`: 1 if individual `\(i\)` living in municipality `\(m\)` migrates to the US in year-quarter `\(t\)`
  
- `\(X_{mti}\)`: Socio-economic characteristics of individual `\(i\)` living in municipality `\(m\)` and year-quarter `\(t\)`
  
- `\(fence_{mti}\in[0,1]\)`: 1 if fence construction started in municipality `\(m\)` in or before year-quarter `\(t\)`
  
- `\(\gamma_m\)`, `\(\tau_t\)`: Municipality and year-quarter fixed effects
]
.panel[.panel-name[Code]


```r
# Define the regression formula
full_formula &lt;- formula(
  migrate ~ fence + female + age + educ + married + 
    municipality + period
)

# Fit a linear probability model according to the formula above and set the data source to 
# the `df_mig` data set
lp_model &lt;- lm(full_formula, data = df_mig)
```

]
.panel[.panel-name[Summary]
.scroll-box-20[

```r
summary(lp_model)
```

```
## 
## Call:
## lm(formula = full_formula, data = df_mig)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.04002 -0.00498 -0.00320 -0.00150  1.00246 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        9.056e-03  1.257e-03   7.205 5.84e-13 ***
## fence             -1.785e-03  7.872e-04  -2.267  0.02338 *  
## female            -1.567e-03  2.908e-04  -5.389 7.08e-08 ***
## age               -5.338e-05  1.184e-05  -4.509 6.51e-06 ***
## educ               2.780e-05  3.659e-05   0.760  0.44737    
## married           -2.145e-03  3.186e-04  -6.733 1.66e-11 ***
## municipality2002  -1.957e-03  3.827e-04  -5.113 3.17e-07 ***
## municipality2003  -3.514e-04  8.658e-04  -0.406  0.68485    
## municipality5025   9.403e-04  1.147e-03   0.820  0.41248    
## municipality5002  -9.478e-04  1.095e-03  -0.866  0.38667    
## municipality5014   1.598e-03  2.312e-03   0.691  0.48944    
## municipality8037  -2.636e-06  6.098e-04  -0.004  0.99655    
## municipality8005  -5.258e-03  1.150e-02  -0.457  0.64749    
## municipality26055  3.292e-03  1.073e-03   3.068  0.00216 ** 
## municipality26043 -5.750e-04  1.006e-03  -0.572  0.56759    
## municipality26002  2.810e-03  1.591e-03   1.766  0.07744 .  
## municipality26017 -3.235e-03  2.275e-03  -1.422  0.15511    
## municipality26048 -3.648e-03  1.974e-03  -1.848  0.06462 .  
## municipality28032  9.533e-05  7.259e-04   0.131  0.89552    
## municipality28022  1.379e-03  7.583e-04   1.819  0.06891 .  
## municipality28027 -7.082e-04  9.433e-04  -0.751  0.45279    
## municipality28033  6.746e-04  9.927e-04   0.680  0.49679    
## municipality28040  2.162e-03  1.253e-03   1.725  0.08449 .  
## municipality28025  2.335e-03  2.435e-03   0.959  0.33768    
## municipality28024 -5.318e-03  9.146e-03  -0.581  0.56097    
## municipality28007 -4.734e-04  2.602e-03  -0.182  0.85564    
## municipality28015  3.179e-02  7.776e-03   4.088 4.36e-05 ***
## municipality28014 -3.729e-03  1.285e-02  -0.290  0.77170    
## period0.75        -5.953e-04  1.452e-03  -0.410  0.68186    
## period1           -3.480e-04  1.460e-03  -0.238  0.81154    
## period1.25        -1.472e-03  1.475e-03  -0.998  0.31812    
## period1.5         -2.610e-03  1.507e-03  -1.732  0.08334 .  
## period1.75        -1.559e-03  1.486e-03  -1.049  0.29404    
## period10          -1.426e-03  1.643e-03  -0.868  0.38551    
## period10.25       -1.872e-03  1.628e-03  -1.150  0.25018    
## period10.5        -9.172e-04  1.622e-03  -0.566  0.57168    
## period2            6.278e-04  1.558e-03   0.403  0.68708    
## period2.25         1.177e-03  1.454e-03   0.810  0.41822    
## period2.5         -1.929e-03  1.447e-03  -1.333  0.18246    
## period2.75        -3.048e-03  1.447e-03  -2.107  0.03515 *  
## period3           -9.030e-04  1.439e-03  -0.628  0.53027    
## period3.25        -4.440e-04  1.449e-03  -0.306  0.75926    
## period3.5         -3.515e-05  1.444e-03  -0.024  0.98058    
## period3.75        -2.243e-03  1.437e-03  -1.561  0.11860    
## period4            1.349e-04  1.439e-03   0.094  0.92530    
## period4.25         3.359e-04  1.443e-03   0.233  0.81594    
## period4.5          5.693e-04  1.561e-03   0.365  0.71540    
## period4.75         5.789e-05  1.565e-03   0.037  0.97050    
## period5           -1.235e-04  1.568e-03  -0.079  0.93722    
## period5.25        -5.292e-04  1.562e-03  -0.339  0.73474    
## period5.5         -6.812e-04  1.603e-03  -0.425  0.67079    
## period5.75        -3.699e-05  1.624e-03  -0.023  0.98182    
## period6            5.415e-04  1.611e-03   0.336  0.73673    
## period6.25        -1.117e-03  1.619e-03  -0.690  0.49023    
## period6.5          9.056e-04  1.626e-03   0.557  0.57754    
## period6.75         3.579e-04  1.624e-03   0.220  0.82555    
## period7           -1.761e-03  1.623e-03  -1.085  0.27804    
## period7.25        -1.258e-03  1.618e-03  -0.777  0.43693    
## period7.5         -1.675e-03  1.619e-03  -1.034  0.30093    
## period7.75        -8.227e-04  1.610e-03  -0.511  0.60946    
## period8           -1.728e-03  1.616e-03  -1.069  0.28509    
## period8.25        -1.862e-03  1.634e-03  -1.139  0.25455    
## period8.5         -8.541e-04  1.626e-03  -0.525  0.59937    
## period8.75        -1.619e-04  1.634e-03  -0.099  0.92106    
## period9           -3.342e-04  1.625e-03  -0.206  0.83701    
## period9.25        -5.943e-04  1.624e-03  -0.366  0.71447    
## period9.5         -2.016e-03  1.647e-03  -1.224  0.22102    
## period9.75        -2.042e-03  1.642e-03  -1.244  0.21368    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.05741 on 156045 degrees of freedom
## Multiple R-squared:  0.001982,	Adjusted R-squared:  0.001553 
## F-statistic: 4.625 on 67 and 156045 DF,  p-value: &lt; 2.2e-16
```
]
]
.panel[.panel-name[Summary (`tidy`)]
.scroll-box-20[

```r
# Print a tidy model summary to the console (remove FE and model fit from the table)
broom::tidy(lp_model) %&gt;% 
  filter(term %in% c("fence", "female", "age", "educ", "married"))
```

```
## # A tibble: 5 × 5
##   term      estimate std.error statistic  p.value
##   &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 fence   -0.00178   0.000787     -2.27  2.34e- 2
## 2 female  -0.00157   0.000291     -5.39  7.08e- 8
## 3 age     -0.0000534 0.0000118    -4.51  6.51e- 6
## 4 educ     0.0000278 0.0000366     0.760 4.47e- 1
## 5 married -0.00214   0.000319     -6.73  1.66e-11
```
]
]
]

---

## The `lm` Class

.pull-left[
- Models created through base R's `lm()` function are stored in list objects with the class `lm`

- An object of class `lm` stores several model details such as

  - `coefficients`: Named coefficient vector
  - `fitted.values`: Vector of predicted values from the regression (i.e. `\(\hat{Y}_{mti}\)`)
  - `residuals`: Vector of residuals from the regression (i.e. `\(Y_{mti}-\hat{Y}_{mti}\)`)
  
- Several generic functions, such as `summary()` and `print()`, work with the `lm` Class, e.g. the `tidy()` function from the `broom` package takes an `lm` object, extracts the coefficients and t-tests, and returns a tidy data set (see previous slide)
]
.pull-right[


```r
class(lp_model)
```

```
## [1] "lm"
```

```r
# Alternatively, use the `coef()` function
lp_model$coefficients[1:3]
```

```
##  (Intercept)        fence       female 
##  0.009055521 -0.001784673 -0.001567282
```


]

---

## Adjusting Standard Errors

.pull-left[
- In many cases, errors are heterogeneous, i.e. the variance of the error term is nonconstant

  - Estimates are unbiased but inefficient, leading to incorrect p-values
  - Can lead to rejecting a true / failing to reject a false null hypothesis

- Can be checked using a Breusch-Pagan test, e.g. via the `bgtest` function from the `lmtest`

- Often a visual inspection is sufficient to suspect a violation of the homoscedasticity assumption

- The `sandwich` package offers an easy way to create heteroscedasticity-consistent (robust) standard errors

- Using the `coeftest` function from the `lmtest`, we can adjust our t-tests for robust standard errors
]

.pull-right[
.panelset[
.panel[.panel-name[Code]

```r
library(lmtest)
library(sandwich)

# Specify covariance matrix computed by the 
# sandwich package using the vcovHC() function 
# and specifying "HC3" as the type of robust
# standard error (i.e. efficient covariance 
# matrix estimator even in small samples)
lp_coeftest &lt;- coeftest(
  lp_model,
  vcov. = vcovHC(lp_model, type = "HC3")
)

broom::tidy(lp_coeftest)
```
]
.panel[.panel-name[Output]
.scroll-box-20[

```
## Lade nötiges Paket: zoo
```

```
## 
## Attache Paket: 'zoo'
```

```
## Die folgenden Objekte sind maskiert von 'package:base':
## 
##     as.Date, as.Date.numeric
```

```
## # A tibble: 68 × 5
##    term               estimate std.error statistic  p.value
##    &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 (Intercept)       0.00906   0.00152       5.94  2.81e- 9
##  2 fence            -0.00178   0.000888     -2.01  4.45e- 2
##  3 female           -0.00157   0.000290     -5.40  6.61e- 8
##  4 age              -0.0000534 0.0000110    -4.86  1.19e- 6
##  5 educ              0.0000278 0.0000353     0.788 4.31e- 1
##  6 married          -0.00214   0.000321     -6.69  2.21e-11
##  7 municipality2002 -0.00196   0.000320     -6.11  1.01e- 9
##  8 municipality2003 -0.000351  0.000850     -0.413 6.79e- 1
##  9 municipality5025  0.000940  0.00135       0.698 4.85e- 1
## 10 municipality5002 -0.000948  0.00101      -0.937 3.49e- 1
## # ℹ 58 more rows
```
]
]
]
]

---

## Cluster-Robust Standard Errors

.pull-left[
- A particular type of homoscedasticity violation is usually found when the data is structured hierarchically

- Observations may be correlated within groups (clusters) but independent across groups: Violates the assumption that errors are independent

- In [Feigenberg (2020a)](https://www.aeaweb.org/articles?id=10.1257/app.20170231): One-way clustering standard errors on municipality level

- Note that the code on the right uses the robust standard error `type` "HC1" as a default
]

.pull-right[
.panelset[
.panel[.panel-name[Code]

```r
library(lmtest)
library(sandwich)

# Use clustered standard errors; clustering
# variable can be provided in a formula
lp_coeftest_CL &lt;- coeftest(
  lp_model,
  vcov. = vcovCL(
    lp_model, 
    cluster = ~ municipality
  )
)

broom::tidy(lp_coeftest_CL)
```
]
.panel[.panel-name[Output]
.scroll-box-20[

```
## # A tibble: 68 × 5
##    term               estimate std.error statistic   p.value
##    &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 (Intercept)       0.00906   0.00275       3.30  9.80e-  4
##  2 fence            -0.00178   0.000921     -1.94  5.27e-  2
##  3 female           -0.00157   0.000438     -3.58  3.46e-  4
##  4 age              -0.0000534 0.0000132    -4.05  5.08e-  5
##  5 educ              0.0000278 0.0000687     0.405 6.86e-  1
##  6 married          -0.00214   0.000529     -4.06  4.96e-  5
##  7 municipality2002 -0.00196   0.0000786   -24.9   2.05e-136
##  8 municipality2003 -0.000351  0.0000392    -8.96  3.30e- 19
##  9 municipality5025  0.000940  0.0000967     9.72  2.44e- 22
## 10 municipality5002 -0.000948  0.000159     -5.95  2.68e-  9
## # ℹ 58 more rows
```
]
]
]
]

---

## Fitting a Logit Model in base R

.panelset[
.panel[.panel-name[Task]
Replicate the results of [Feigenberg (2020a)](https://www.aeaweb.org/articles?id=10.1257/app.20170231) using their logit model. Implement the model in base R.

`$$Pr(Y_{mti}=1\mid z_{mti})=\wedge\left({\alpha+X_{mti}\beta+\delta\times fence_{mti}+\gamma_m+\tau_t}\right)$$`

- `\(Y_{mti}\in[0,1]\)`: 1 if individual `\(i\)` living in municipality `\(m\)` migrates to the US in year-quarter `\(t\)`
  
- `\(X_{mti}\)`: Socio-economic characteristics of individual `\(i\)` living in municipality `\(m\)` and year-quarter `\(t\)`
  
- `\(fence_{mti}\in[0,1]\)`: 1 if fence construction started in municipality `\(m\)` in or before year-quarter `\(t\)`
  
- `\(\gamma_m\)`, `\(\tau_t\)`: Municipality and year-quarter fixed effects
]
.panel[.panel-name[Code]


```r
# Fit a logit model as given by formula on the df_mig data set
logit_model &lt;- glm(full_formula, data = df_mig, family = "binomial")
```

]
.panel[.panel-name[Summary]
.scroll-box-20[

```r
summary(logit_model)
```

```
## 
## Call:
## glm(formula = full_formula, family = "binomial", data = df_mig)
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)        -4.282496   0.312529 -13.703  &lt; 2e-16 ***
## fence              -0.470669   0.206658  -2.278  0.02275 *  
## female             -0.472763   0.091037  -5.193 2.07e-07 ***
## age                -0.016581   0.003900  -4.251 2.13e-05 ***
## educ                0.011944   0.011479   1.041  0.29810    
## married            -0.626415   0.101308  -6.183 6.28e-10 ***
## municipality2002   -0.832191   0.151951  -5.477 4.33e-08 ***
## municipality2003   -0.107081   0.267432  -0.400  0.68886    
## municipality5025    0.214479   0.299088   0.717  0.47331    
## municipality5002   -0.299108   0.361834  -0.827  0.40844    
## municipality5014    0.326634   0.520928   0.627  0.53064    
## municipality8037    0.000871   0.183327   0.005  0.99621    
## municipality8005  -10.255878 286.555816  -0.036  0.97145    
## municipality26055   0.688621   0.235953   2.918  0.00352 ** 
## municipality26043  -0.180382   0.323965  -0.557  0.57767    
## municipality26002   0.646944   0.362868   1.783  0.07461 .  
## municipality26017  -1.141055   1.010083  -1.130  0.25862    
## municipality26048  -1.463278   1.009101  -1.450  0.14704    
## municipality28032   0.017811   0.206706   0.086  0.93134    
## municipality28022   0.323573   0.192650   1.680  0.09304 .  
## municipality28027  -0.153831   0.258756  -0.595  0.55218    
## municipality28033   0.168433   0.270033   0.624  0.53279    
## municipality28040   0.397760   0.279091   1.425  0.15410    
## municipality28025   0.472456   0.531500   0.889  0.37405    
## municipality28024 -10.306214 225.805853  -0.046  0.96360    
## municipality28007  -0.075660   0.721612  -0.105  0.91650    
## municipality28015   2.158672   0.748005   2.886  0.00390 ** 
## municipality28014  -9.948545 319.578972  -0.031  0.97517    
## period0.75         -0.079229   0.352417  -0.225  0.82212    
## period1            -0.029674   0.355996  -0.083  0.93357    
## period1.25         -0.300065   0.384999  -0.779  0.43575    
## period1.5          -0.675446   0.443250  -1.524  0.12755    
## period1.75         -0.321688   0.393264  -0.818  0.41336    
## period10           -0.481702   0.501133  -0.961  0.33644    
## period10.25        -0.719259   0.524815  -1.371  0.17053    
## period10.5         -0.242398   0.457728  -0.530  0.59641    
## period2             0.156736   0.365918   0.428  0.66841    
## period2.25          0.254890   0.336052   0.758  0.44816    
## period2.5          -0.433050   0.393531  -1.100  0.27115    
## period2.75         -0.872909   0.443225  -1.969  0.04890 *  
## period3            -0.156499   0.360832  -0.434  0.66449    
## period3.25         -0.039417   0.356433  -0.111  0.91194    
## period3.5           0.035305   0.348289   0.101  0.91926    
## period3.75         -0.558091   0.403137  -1.384  0.16625    
## period4             0.076312   0.345376   0.221  0.82513    
## period4.25          0.120965   0.345691   0.350  0.72640    
## period4.5           0.194740   0.385705   0.505  0.61363    
## period4.75          0.065801   0.397242   0.166  0.86844    
## period5             0.024456   0.404961   0.060  0.95184    
## period5.25         -0.107001   0.409307  -0.261  0.79377    
## period5.5          -0.149811   0.437833  -0.342  0.73223    
## period5.75          0.062115   0.428457   0.145  0.88473    
## period6             0.211933   0.410388   0.516  0.60556    
## period6.25         -0.326540   0.467019  -0.699  0.48443    
## period6.5           0.288662   0.406448   0.710  0.47758    
## period6.75          0.156364   0.416087   0.376  0.70707    
## period7            -0.621163   0.499306  -1.244  0.21348    
## period7.25         -0.375069   0.466352  -0.804  0.42125    
## period7.5          -0.597854   0.499724  -1.196  0.23155    
## period7.75         -0.208341   0.444563  -0.469  0.63933    
## period8            -0.611450   0.499453  -1.224  0.22086    
## period8.25         -0.700673   0.523043  -1.340  0.18037    
## period8.5          -0.217656   0.454757  -0.479  0.63221    
## period8.75          0.022308   0.436762   0.051  0.95927    
## period9            -0.035583   0.436379  -0.082  0.93501    
## period9.25         -0.116651   0.445605  -0.262  0.79349    
## period9.5          -0.819681   0.554295  -1.479  0.13920    
## period9.75         -0.837408   0.554304  -1.511  0.13086    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 6936.7  on 156112  degrees of freedom
## Residual deviance: 6637.6  on 156045  degrees of freedom
## AIC: 6773.6
## 
## Number of Fisher Scoring iterations: 14
```
]
]
.panel[.panel-name[Summary (`tidy`)]
.scroll-box-20[

```r
# Print a tidy model summary to the console
broom::tidy(logit_model) %&gt;% 
  filter(term %in% c("fence", "female", "age", "educ", "married"))
```

```
## # A tibble: 5 × 5
##   term    estimate std.error statistic  p.value
##   &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 fence    -0.471    0.207       -2.28 2.28e- 2
## 2 female   -0.473    0.0910      -5.19 2.07e- 7
## 3 age      -0.0166   0.00390     -4.25 2.13e- 5
## 4 educ      0.0119   0.0115       1.04 2.98e- 1
## 5 married  -0.626    0.101       -6.18 6.28e-10
```
]
]
]

---

layout: true

## Computing Marginal Effects

---

- Coefficients from a Logit model are not directly interpretable: A one-unit change in the covariate corresponds to a change in *log odds*

- Odds ratios provide a more intuitive measure of the relative impact of covariates on the outcome, i.e. `$$\text{Odds Ratio}=e^{\beta}$$`

  - `\(\text{Odds Ratio}&gt;1\)`: Odds for `\(P(Y=1)\)` increase with a one-unit increase in `\(X\)`
  
  - `\(\text{Odds Ratio}&lt;1\)`: Odds for `\(P(Y=1)\)` decrease with a one-unit increase in `\(X\)`
  
---

.pull-left[
- Unlike odds ratios, marginal effects directly tell the change in probability a one-unit change in the covariate has on the outcome, i.e. `\(\text{Marginal Effect}=\frac{\partial P(Y=1)}{\partial X}\)`

- We can use this measure for understanding the magnitude of impact on the outcome in terms of probabilities

- Due to the non-linearity in the outcome, it is important to correctly choose *where* to evaluate the marginal effect: For a central tendency, choose the sample mean, i.e. compute the **average marginal effect (AME)**

- The `marginaleffects` package offers several functions to help you with computing marginal effects; uses the `sandwich` package for robust covariance matrix estimation
]

.pull-right[
.panelset[
.panel[.panel-name[Code]

```r
library(marginaleffects)

# avg_slopes returns the AME
logit_me &lt;- avg_slopes(logit_model)

broom::tidy(logit_me)
```
]
.panel[.panel-name[Output]
.scroll-box-20[

```
## # A tibble: 67 × 3
##    term         contrast       estimate
##    &lt;chr&gt;        &lt;chr&gt;             &lt;dbl&gt;
##  1 age          dY/dX        -0.0000546
##  2 educ         dY/dX         0.0000393
##  3 female       1 - 0        -0.00153  
##  4 fence        1 - 0        -0.00156  
##  5 married      1 - 0        -0.00204  
##  6 municipality 2002 - 2004  -0.00204  
##  7 municipality 2003 - 2004  -0.000366 
##  8 municipality 26002 - 2004  0.00326  
##  9 municipality 26017 - 2004 -0.00246  
## 10 municipality 26043 - 2004 -0.000595 
## # ℹ 57 more rows
```
]
]
]
]

---

layout: false

## CRAN Task View: Econometrics

- Base R already provides lots of functions for (applied) econometrics, especially the `stats` package but

  - Many "advanced" estimators, however, are not readily available in base R
  - Some base R functions show poor performance when applied on large data sets
  
- The "CRAN Task View: Econometrics" &lt;a name=cite-cran_task_view&gt;&lt;/a&gt;([Zeilis, McDermott, and Tappe, 2024](https://CRAN.R-project.org/view=Econometrics)) provides a comprehensive overview of very useful packages that complement your analysis, e.g.

  - `fixest`: Fast implementation of high-dimensional fixed effects
  - `lmtest`: Tests, data sets, and examples for diagnostic checking in linear regression models
  - `sandwich`: Model-robust covariance matrix estimators for easy imputation in other packages
  - `modelsummary`: Customizable tables, plots etc. for several statistical models to summarize your results
  
.pull-left.short-width[
.small-emoji[➡️]
]

.pull-right.long-width[
[CRAN Task View: Econometrics](https://cran.r-project.org/web/views/Econometrics.html)
]

---

class: middle

## Speeding Up Computation

---

## Fixed Effects Estimation

- Many microeconometric applications suffer from unobserved heterogeneity: Individuals are often correlated *within* groups of observations (e.g. firms, regions, years)

- Regional characteristics (local economic conditions, cultural norm towards migration, geographic proximity to border) might have a regionally constant, "baseline" effect on the migration decision

- Fixed effects let us focus on *within-region* variation by controlling for time-invariant regional characteristics and general time trends

- Since this is essentially including a (potentially large) set of region and/or year dummies, the estimation of fixed effects models can become computationally extensive even with moderate sample sizes

- The `fixest` package &lt;a name=cite-fixest&gt;&lt;/a&gt;([Bergé, 2018](#bib-fixest)) offers a fast implementation of fixed effects estimators, covering a wide range of (micro-)econometric applications

---

## Fast LPM Implementation

.panelset[
.panel[.panel-name[Code]

.pull-left[
- Fixed effects are specified following `|` on the RHS of the formula

- The `vcov` argument let's you handle the computation of standard errors, e.g. 

  - "iid" for homoscedastic SE
  - "hetero" for heteroscedastic White SE
  - "cluster" for clustered SE

- Generic function `summary()` handles `fixest` models (slightly) different
]
.pull-right[

```r
library(fixest)

fe_lp_model &lt;- feols(
  migrate ~ 
    fence + female + age + educ + married | 
    municipality + period,
  vcov = "cluster",
  data = df_mig
)

summary(fe_lp_model)
```
]
]
.panel[.panel-name[Summary]
.scroll-box-20[

```
## OLS estimation, Dep. Var.: migrate
## Observations: 156,113 
## Fixed-effects: municipality: 23,  period: 41
## Standard-errors: Clustered (municipality) 
##          Estimate Std. Error   t value   Pr(&gt;|t|)    
## fence   -0.001785   0.000921 -1.937784 0.06559061 .  
## female  -0.001567   0.000438 -3.578626 0.00167557 ** 
## age     -0.000053   0.000013 -4.052211 0.00053104 ***
## educ     0.000028   0.000069  0.404796 0.68953676    
## married -0.002145   0.000529 -4.057874 0.00052376 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## RMSE: 0.057395     Adj. R2: 0.001553
##                  Within R2: 9.327e-4
```
]
]
]

---

## Fast Logit Implementation

.panelset[
.panel[.panel-name[Code]

.pull-left[
- Logit models can be easily computed by specifying the corresponding function family ("binomial")

- Overall handling very similar to the base R solution but computationally much faster
]
.pull-right[

```r
fe_logit_model &lt;- feglm(
  migrate ~ 
    fence + female + age + educ + married | 
    municipality + period,
  family = "binomial",
  vcov = "cluster",
  data = df_mig
)

summary(fe_logit_model)
```
]
]
.panel[.panel-name[Summary]
.scroll-box-20[

```
## GLM estimation, family = binomial, Dep. Var.: migrate
## Observations: 156,028 
## Fixed-effects: municipality: 20,  period: 41
## Standard-errors: Clustered (municipality) 
##          Estimate Std. Error   z value   Pr(&gt;|z|)    
## fence   -0.470669   0.211948 -2.220682 2.6373e-02 *  
## female  -0.472763   0.098667 -4.791516 1.6553e-06 ***
## age     -0.016581   0.005254 -3.156070 1.5991e-03 ** 
## educ     0.011944   0.021102  0.566025 5.7138e-01    
## married -0.626415   0.104565 -5.990698 2.0894e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## Log-Likelihood: -3,318.8   Adj. Pseudo R2: 0.024585
##            BIC:  7,414.9     Squared Cor.: 0.002821
```
]
]
]

---

## Performing Multiple Estimations

.panelset[
.panel[.panel-name[Code]

.pull-left[
- Different model specifications serve different purposes, i.e. robustness checks, investigating effect heterogeneity, transforming variables

- `fixest` offers easy ways to handle mutliple LHS and/or RHS estimations

  - Wrap outcome variables inside a vector, e.g. `c(y1, y2) ~ x1`
  - Use the `sw()` function for stepwise replacement of the RHS, e.g. `y ~ x1 + sw(x2, x3)` evaluates to `y ~ x1 + x2` and `y ~ x1 + x3`
  - Use the `csw()` for stepwise adding of variables to the RHS, e.g. `y ~ csw(x1 + x2, x3)` evaluates to `y ~ x1 + x2` and `y ~ x1 + x2 + x3`
]
.pull-right[

```r
library(fixest)

fe_lp_models &lt;- feols(
  migrate ~ 
    csw(fence, female + age + educ + married) | 
    municipality + period,
  vcov = "cluster",
  data = df_mig
)

summary(fe_lp_models)
```
]
]
.panel[.panel-name[Summary]
.scroll-box-20[

```
## Standard-errors: Clustered (municipality) 
## Expl. vars.: fence
##        Estimate Std. Error  t value Pr(&gt;|t|)    
## fence -0.001741   0.000919 -1.89585 0.071192 .  
## ---
## Expl. vars.: fence + female + age + educ + married
##          Estimate Std. Error   t value   Pr(&gt;|t|)    
## fence   -0.001785   0.000921 -1.937784 0.06559061 .  
## female  -0.001567   0.000438 -3.578626 0.00167557 ** 
## age     -0.000053   0.000013 -4.052211 0.00053104 ***
## educ     0.000028   0.000069  0.404796 0.68953676    
## married -0.002145   0.000529 -4.057874 0.00052376 ***
```
]
]
]

---

class: middle

## Creating Regression Tables

---

layout: true

## Regression Tables

&gt; A variety of packages offers solutions to create off-the-shelve tables for regression output. The `msummary()` from the `modelsummary` package takes an `lm` object &amp;ndash; or a (named) list of `lm` objects &amp;ndash; as input and returns a customizable regression table.

---

.pull-left[

```r
msummary(
  models,
  output = "default",
  vcov = NULL,
  stars = FALSE,
  title = NULL,
  notes = NULL,
  coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

---

.pull-left[

```r
msummary(
* models,
  output = "default",
  vcov = NULL,
  stars = FALSE,
  title = NULL,
  notes = NULL,
  coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

.pull-right[
`models`

A model object, such as `lm`, or a (named) list of models.
]

---

.pull-left[

```r
msummary(
  models,
* output = "default",
  vcov = NULL,
  stars = FALSE,
  title = NULL,
  notes = NULL,
  coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

.pull-right[
`output`

If the table should be saved directly, the filename can be specified here. If the table should be customized afterwards, this argument should be set to the desired object type, e. g. `"kableExtra"`.
]

---

.pull-left[

```r
msummary(
  models,
  output = "default",
* vcov = NULL,
  stars = FALSE,
  title = NULL,
  notes = NULL,
  coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

.pull-right[
`vcov`

Replace model standard errors with robust standard errors by setting this argument to `"HC3"` or other variants of heteroscedasticity-consistent standard errors. Including robust standard errors in the table requires the `sandwich` package.
]

---

.pull-left[

```r
msummary(
  models,
  output = "default",
  vcov = NULL,
* stars = FALSE,
  title = NULL,
  notes = NULL,
  coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

.pull-right[
`stars`

Show stars to indicate statistical significance by passing a named numeric vector to this argument. Most commonly, this would be set to:

`c("*" = .1, "**" = .05, "***" = .01)`
]

---

.pull-left[

```r
msummary(
  models,
  output = "default",
  vcov = NULL,
  stars = FALSE,
* title = NULL,
  notes = NULL,
  coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

.pull-right[
`title`

Title for the table given as a string.
]

---

.pull-left[

```r
msummary(
  models,
  output = "default",
  vcov = NULL,
  stars = FALSE,
  title = NULL,
* notes = NULL,
  coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

.pull-right[
`notes`

Pass a list or vector of strings to this arguments to show notes below the table.
]

---

.pull-left[

```r
msummary(
  models,
  output = "default",
  vcov = NULL,
  stars = FALSE,
  title = NULL,
  notes = NULL,
* coef_map = NULL,
  gof_map = NULL,
  ...
)
```
]

.pull-right[
`coef_map`

Use a named character vector to map model variable names to coefficient names, e. g. `c(female = "Female")`. Coefficients are shown in the order of the character vector. If a coefficient is not given in the vector, it will be omitted from the table.
]

---

.pull-left[

```r
msummary(
  models,
  output = "default",
  vcov = NULL,
  stars = FALSE,
  title = NULL,
  notes = NULL,
  coef_map = NULL,
* gof_map = NULL,
  ...
)
```
]

.pull-right[
`gof_map`

A character vector specifying goodness-of-fit statistics and other model information to show at the bottom of the table. Measures are reported in the order given in the vector. See `get_gof(&lt;YOUR-MODEL&gt;)` for a list of measures to choose from. Names of the `data.frame` correspond to measure names that have to be provided to show in the table.

If you want to use a custom name for the measures, you can pass a `data.frame` object with the columns `"raw"`, `"clean"` and `"fmt"` instead of a character vector.
]

---

layout: false

## Creating Regression Tables

.panelset[
.panel[.panel-name[Task]
Use the `msummary()` function from the `modelsummary` package to create a table showing the results from the LPM and the logit models used so far.

Show only coefficients for your variable of interest and additional controls. Cluster standard errors on municipality level.
]
.panel[.panel-name[Code (models)]

```r
library(modelsummary)

formula &lt;- migrate ~ 
  csw(fence, female + age + educ + married) | municipality + period

lpm &lt;- feols(formula, vcov = "cluster", data = df_mig)

logit &lt;- feglm(formula, family = "binomial", vcov = "cluster", data = df_mig)
```

```
## NOTE: 3/0 fixed-effects (85 observations) removed because of only 0 (or only 1) outcomes.
```
]
.panel[.panel-name[Code (table)]

```r
msummary(
  list(lpm, logit),
  output = "kableExtra",
  col.names = c("", "(1)", "(2)", "(3)", "(4)"),
  stars = c("*" = .1, "**" = .05, "***" = .01),
  title = "Impact of Fence Construction on Mexico-US Migration",
  notes = str_c(
    "Columns (1) and (2) show OLS results, columns (3) and (4) show Logit results. ",
    "Parantheses show clustered standard errors."
  ),
  coef_map = c(
    fence = "Fence Construction", age = "Age", female = "Female", 
    educ = "Years of Schooling", married = "Married"
  ),
  gof_map = c(
    "r2", "r2.adjusted", "r2.within", "r2.within.adjusted", "nobs"
  )
)
```
]
]

---

class: middle

&lt;table style="NAborder-bottom: 0; width: auto !important; margin-left: auto; margin-right: auto;" class="table"&gt;
&lt;caption&gt;Impact of Fence Construction on Mexico-US Migration&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;  &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; (1) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; (2) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; (3) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; (4) &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Fence Construction &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.002* &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.002* &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.449** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.471** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.001) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.001) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.213) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.212) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Age &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.000*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.017*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.000) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.005) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Female &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.002*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.473*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.000) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.099) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Years of Schooling &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.012 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.000) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; (0.021) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Married &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.002*** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -0.626*** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.001) &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt;  &lt;/td&gt;
   &lt;td style="text-align:center;box-shadow: 0px 1.5px"&gt; (0.105) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 Within &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.001 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.001 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.021 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2 Within Adj. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.000 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.001 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.001 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0.020 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Num.Obs. &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 156113 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 156113 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 156028 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 156028 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;tfoot&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; * p &amp;lt; 0.1, ** p &amp;lt; 0.05, *** p &amp;lt; 0.01&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td style="padding: 0; " colspan="100%"&gt;
&lt;sup&gt;&lt;/sup&gt; Columns (1) and (2) show OLS results, columns (3) and (4) show Logit results. Parantheses show clustered standard errors.&lt;/td&gt;&lt;/tr&gt;
&lt;/tfoot&gt;
&lt;/table&gt;

---

layout: true

# References

---

&lt;a name=bib-fixest&gt;&lt;/a&gt;[Bergé, L.](#cite-fixest) (2018). "Efficient
estimation of maximum likelihood models with multiple fixed-effects:
the R package FENmlm". In: _CREA Discussion Papers_.

&lt;a name=bib-f20&gt;&lt;/a&gt;[Feigenberg, B.](#cite-f20) (2020a). "Fenced Out:
The Impact of Border Construction on US-Mexico Migration". In:
_American Economic Journal: Applied Economics_ 12.3, pp. 106-39. DOI:
[10.1257/app.20170231](https://doi.org/10.1257%2Fapp.20170231). URL:
[https://www.aeaweb.org/articles?id=10.1257/app.20170231](https://www.aeaweb.org/articles?id=10.1257/app.20170231).

&lt;a name=bib-f20data&gt;&lt;/a&gt;[Feigenberg, B.](#cite-f20data) (2020b).
_Replication package for: Fenced Out: The Impact of Border Construction
on US-Mexico Migration._ American Economic Association. URL:
[https://www.aeaweb.org/journals/dataset?id=10.1257/app.20170231](https://www.aeaweb.org/journals/dataset?id=10.1257/app.20170231).

&lt;a name=bib-r4ds&gt;&lt;/a&gt;[Wickham, H. and G. Grolemund](#cite-r4ds) (2016).
_R for data science. import, tidy, transform, visualize, and model
data_. O'Reilly. URL:
[https://r4ds.had.co.nz/](https://r4ds.had.co.nz/).

&lt;a name=bib-cran_task_view&gt;&lt;/a&gt;[Zeilis, A., G. McDermott, and K.
Tappe](#cite-cran_task_view) (2024). _CRAN Task View: Econometrics_.
Version 2024-06-03. URL:
[https://CRAN.R-project.org/view=Econometrics](https://CRAN.R-project.org/view=Econometrics).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
